# ğŸ¦ KKClaw Desktop Pet å…¨æ–¹ä½åŠŸèƒ½ä»‹ç»

**å®Œæ•´æŠ€æœ¯æ–‡æ¡£ + ä½¿ç”¨æŒ‡å— + æœ€ä½³å®è·µ**

---

## ğŸ“š ç›®å½•

1. [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
2. [UIç³»ç»Ÿè¯¦è§£](#uiç³»ç»Ÿè¯¦è§£)
3. [æƒ…ç»ªä¸è¡¨æƒ…ç³»ç»Ÿ](#æƒ…ç»ªä¸è¡¨æƒ…ç³»ç»Ÿ)
4. [æ™ºèƒ½è¯­éŸ³ç³»ç»Ÿ](#æ™ºèƒ½è¯­éŸ³ç³»ç»Ÿ)
5. [KKClaw Switché›†æˆ](#kkclaw-switché›†æˆ)
6. [å·¥å…·æ ä¸äº¤äº’](#å·¥å…·æ ä¸äº¤äº’)
7. [ç¨³å®šæ€§ç³»ç»Ÿ](#ç¨³å®šæ€§ç³»ç»Ÿ)
8. [é…ç½®ä¸å®šåˆ¶](#é…ç½®ä¸å®šåˆ¶)
9. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
10. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)

---

## æ ¸å¿ƒæ¦‚å¿µ

### ä»€ä¹ˆæ˜¯KKClaw Desktop Petï¼Ÿ

**ä¸€å¥è¯æ€»ç»“**ï¼šç»™OpenClaw AIä¸€ä¸ªå¯è§†åŒ–çš„èº«ä½“ï¼Œè®©AIä»èŠå¤©æ¡†èµ°åˆ°æ¡Œé¢ä¸Šã€‚

**è®¾è®¡å“²å­¦**ï¼š
- **ç©ºæ°”æ„Ÿ** â€” åƒæ¡Œé¢æ­Œè¯ï¼Œå­˜åœ¨ä½†ä¸æ‰“æ‰°
- **æœ‰æ¸©åº¦** â€” ä¸æ˜¯å·¥å…·ï¼Œæ˜¯ä¼™ä¼´
- **é«˜æ•ˆç‡** â€” 7Ã—24è¿è¡Œï¼Œæ°¸ä¸æ‰çº¿
- **å¯å®šåˆ¶** â€” ä»å¤–è§‚åˆ°è¡Œä¸ºï¼Œå®Œå…¨å¯æ§

**æ ¸å¿ƒä»·å€¼**ï¼š
1. **è§†è§‰åŒ–** â€” æŠŠAIçš„çŠ¶æ€ã€æƒ…ç»ªã€æ€è€ƒè¿‡ç¨‹å¯è§†åŒ–
2. **é™ªä¼´æ„Ÿ** â€” ä¸æ˜¯ç”¨å®Œå°±å…³çš„å·¥å…·ï¼Œè€Œæ˜¯é•¿æœŸé™ªä¼´çš„å­˜åœ¨
3. **æ•ˆç‡æå‡** â€” å¿«æ·æ“ä½œï¼ˆæˆªå›¾ã€è¯­éŸ³ã€æ¨¡å‹åˆ‡æ¢ï¼‰
4. **æƒ…æ„Ÿè¿æ¥** â€” 7ç§æƒ…ç»ªã€38ç§è¡¨æƒ…ï¼Œè®©AIæœ‰äº†"äººæ ¼"

---

## UIç³»ç»Ÿè¯¦è§£

### åŒçª—å£æ¶æ„

#### è®¾è®¡ç†å¿µ

ä¼ ç»Ÿæ¡Œé¢å® ç‰©çš„é—®é¢˜ï¼š
- âŒ å•çª—å£å ç”¨ç©ºé—´å¤§
- âŒ é®æŒ¡å·¥ä½œåŒºåŸŸ
- âŒ äº¤äº’ä¸ä¾¿

KKClawçš„è§£å†³æ–¹æ¡ˆï¼š
- âœ… ç²¾çµçª—å£ï¼ˆ200Ã—220pxï¼‰â€” æœ€å°åŒ–è§†è§‰å ç”¨
- âœ… æ­Œè¯çª—å£ï¼ˆ400Ã—100pxï¼‰â€” å®Œå…¨é¼ æ ‡ç©¿é€
- âœ… æ‹–åŠ¨åŒæ­¥ â€” ä¸¤çª—å£è”åŠ¨

---

### ç²¾çµçª—å£ï¼ˆPet Windowï¼‰

**å°ºå¯¸**ï¼š200px Ã— 220px  
**ç‰¹æ€§**ï¼šåŠé€æ˜èƒŒæ™¯ã€æ°¸è¿œç½®é¡¶ã€å¯æ‹–åŠ¨

#### ç»„æˆéƒ¨åˆ†

**1. ç‰ç’ƒçƒä½“ï¼ˆ67pxï¼‰**

```
ç»“æ„åˆ†å±‚ï¼ˆç”±å†…åˆ°å¤–ï¼‰ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: å†…éƒ¨æµä½“å±‚          â”‚
â”‚  - blob1 (20Ã—20px åœ†å½¢)     â”‚
â”‚  - blob2 (30Ã—30px æ¤­åœ†)     â”‚
â”‚  - åŠ¨ç”»é€Ÿåº¦: 20s / 25s      â”‚
â”‚  - æ— é™å¾ªç¯åŠ¨ç”»              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: ç»ç’ƒå¤–å£³           â”‚
â”‚  - 3å±‚å¾„å‘æ¸å˜               â”‚
â”‚  - ä¸»é«˜å…‰ (35% at 18%)      â”‚
â”‚  - å‰¯é«˜å…‰ (20% at 12%)      â”‚
â”‚  - 1.5pxåŠé€æ˜border        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: å¤–éƒ¨å‘å…‰           â”‚
â”‚  - å†…å‘å…‰ (inset)            â”‚
â”‚  - å¤–å‘å…‰ (blur 15px)       â”‚
â”‚  - é¢œè‰²éšmoodåŠ¨æ€å˜åŒ–       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è§†è§‰æ•ˆæœ**ï¼š
- ç‰ç’ƒè´¨æ„Ÿï¼š3å±‚æ¸å˜ + åŒé‡é«˜å…‰
- æµä½“åŠ¨ç”»ï¼šå†…éƒ¨blobç¼“æ…¢ç§»åŠ¨
- å‘å…‰æ•ˆæœï¼šæ ¹æ®æƒ…ç»ªå˜è‰²

**æŠ€æœ¯å®ç°**ï¼š
```css
.pet-ball {
  width: 67px;
  height: 67px;
  border-radius: 50%;
  background: radial-gradient(
    circle at 35% 18%,
    rgba(255,255,255,0.8) 0%,
    rgba(255,255,255,0) 15%
  ),
  radial-gradient(...), /* ä¸»ä½“æ¸å˜ */
  linear-gradient(...); /* blobå±‚ */
  box-shadow: 
    inset 0 -10px 30px rgba(255,255,255,0.2),
    0 0 15px currentColor;
  animation: colorShift 1s ease-in-out;
}
```

---

**2. èƒ¶å›Šå½¢çœ¼ç›**

**è®¾è®¡**ï¼š
- å½¢çŠ¶ï¼š11px Ã— 19px èƒ¶å›Šï¼ˆåœ†è§’çŸ©å½¢ï¼‰
- é¢œè‰²ï¼šç™½è‰² + å‘å…‰æ•ˆæœ
- ä½ç½®ï¼šçƒä½“ä¸­å¿ƒåä¸Š
- é—´è·ï¼š30px

**15+ç§è¡¨æƒ…**ï¼š

| è¡¨æƒ… | å°ºå¯¸ | ç‰¹æ®Šæ•ˆæœ | åŠ¨ç”» |
|------|------|----------|------|
| normal | 11Ã—19px | - | - |
| blink | 12Ã—3px | å¿«é€Ÿå‹æ‰ | 0.1s |
| happy | 13Ã—7px | åœ†è§’7px 7px 3px 3px | å¼¯çœ¼å¾®ç¬‘ |
| surprised | 13Ã—21px | æ”¾å¤§110% | çªå¤§çœ¼ |
| thinking | 10Ã—17px | å‘ä¸Šç§»åŠ¨-3px | çœ¯çœ¼æ€è€ƒ |
| sleepy | 12Ã—4px | å‘ä¸‹ç§»åŠ¨2px | åŠé—­çœ¼ |
| sparkle | 12Ã—12px | æ—‹è½¬45deg | æ˜Ÿæ˜Ÿçœ¼ |
| wink | å·¦13Ã—7px, å³11Ã—19px | å•ä¾§happy | çœ¨çœ¼ |
| love | 14Ã—13px | æ—‹è½¬45deg + åœ†è§’ | çˆ±å¿ƒçœ¼ |
| angry | 12Ã—14px | æ—‹è½¬Â±12deg | ç”Ÿæ°”çš±çœ‰ |
| dizzy | 10Ã—10px | æ—‹è½¬Â±25deg | å¤´æ™•æ—‹è½¬ |
| cross | 10Ã—3px | æ—‹è½¬Â±30deg | Xçœ¼è£…æ­» |

**æŠ€æœ¯å®ç°**ï¼š
```javascript
function setEyes(type, params = {}) {
  const leftEye = document.querySelector('.eye-left');
  const rightEye = document.querySelector('.eye-right');
  
  switch(type) {
    case 'happy':
      leftEye.style.width = '13px';
      leftEye.style.height = '7px';
      leftEye.style.borderRadius = '7px 7px 3px 3px';
      break;
    // ... å…¶ä»–è¡¨æƒ…
  }
}
```

---

**3. SVGå›¾æ ‡å·¥å…·æ **

**é»˜è®¤çŠ¶æ€**ï¼šéšè—ï¼ˆopacity: 0ï¼‰  
**hoverè§¦å‘**ï¼šæ·¡å…¥å±•å¼€ï¼ˆ0.3s transitionï¼‰  
**å›¾æ ‡å°ºå¯¸**ï¼š26px Ã— 26px

**4ä¸ªå›¾æ ‡**ï¼š

| å›¾æ ‡ | åŠŸèƒ½ | å¿«æ·é”® | è¯´æ˜ |
|------|------|--------|------|
| ğŸ’¬ | æ‰“å¼€èŠå¤© | Ctrl+Shift+C | èšç„¦åˆ°é£ä¹¦/Telegramå¯¹è¯ |
| ğŸ“¸ | æˆªå›¾ä¸Šä¼  | Ctrl+Shift+S | æˆªå›¾ â†’ è‡ªåŠ¨ä¸Šä¼ åˆ°é£ä¹¦ |
| ğŸ¤ | è¯­éŸ³åˆ‡æ¢ | Ctrl+Shift+V | åˆ‡æ¢TTSå¼•æ“/éŸ³è‰² |
| âš™ï¸ | è®¾ç½®é¢æ¿ | Ctrl+Shift+P | æ‰“å¼€é…ç½®ç•Œé¢ |

**æŠ€æœ¯å®ç°**ï¼š
```html
<div class="toolbar" onmouseenter="showToolbar()">
  <div class="tool-icon" onclick="openChat()">
    <svg>...</svg>
  </div>
  <!-- å…¶ä»–å›¾æ ‡ -->
</div>
```

---

### æ­Œè¯çª—å£ï¼ˆLyrics Windowï¼‰

**å°ºå¯¸**ï¼š400px Ã— 100pxï¼ˆå¯è‡ªåŠ¨æ‰©å±•é«˜åº¦ï¼‰  
**ç‰¹æ€§**ï¼šå®Œå…¨é¼ æ ‡ç©¿é€ã€æ— è¾¹æ¡†ã€é€æ˜èƒŒæ™¯

#### æ ¸å¿ƒç‰¹æ€§

**1. å®Œå…¨é¼ æ ‡ç©¿é€**

```javascript
lyricsWindow.setIgnoreMouseEvents(true, {
  forward: true  // è½¬å‘é¼ æ ‡äº‹ä»¶åˆ°ä¸‹å±‚çª—å£
});
```

**æ•ˆæœ**ï¼š
- âœ… é¼ æ ‡å¯ä»¥ç‚¹å‡»ç©¿è¿‡çª—å£
- âœ… å¯ä»¥æ‹–åŠ¨ä¸‹å±‚çª—å£
- âœ… å¯ä»¥ç¼–è¾‘ç©¿è¿‡çš„æ–‡æ¡£
- âœ… å®Œå…¨ä¸å¦¨ç¢æ“ä½œ

**2. ç™½å­—æè¾¹ï¼ˆ8é‡å åŠ ï¼‰**

```css
.lyrics-text {
  color: white;
  text-shadow:
    -1px -1px 0 #000,  
     1px -1px 0 #000,
    -1px  1px 0 #000,
     1px  1px 0 #000,
     0   -2px 3px #000,
     0    2px 3px #000,
    -2px  0   3px #000,
     2px  0   3px #000;
  font-size: 16px;
  font-weight: 600;
}
```

**æ•ˆæœ**ï¼š
- âœ… ä»»ä½•èƒŒæ™¯éƒ½æ¸…æ™°ï¿½ï¿½ï¿½è§
- âœ… ç™½è‰²å£çº¸ã€é»‘è‰²å£çº¸éƒ½èƒ½çœ‹æ¸…
- âœ… å¤æ‚å›¾ç‰‡èƒŒæ™¯ä¹Ÿä¸å½±å“

**3. æ‰“å­—æœºæ•ˆæœ**

```javascript
async function typeText(text) {
  lyricsElement.textContent = '';
  for (let char of text) {
    lyricsElement.textContent += char;
    await sleep(50); // æ¯å­—ç¬¦50ms
  }
}
```

**æ•ˆæœ**ï¼š
- é€å­—å‡ºç°
- æ”¯æŒemoji
- è‡ªåŠ¨æ¢è¡Œ
- åŠ¨æ€é«˜åº¦è°ƒæ•´

---

### çª—å£åŒæ­¥æœºåˆ¶

**æ‹–åŠ¨åŒæ­¥**ï¼š

```javascript
// ç²¾çµçª—å£ç›‘å¬æ‹–åŠ¨
mainWindow.on('move', () => {
  const [x, y] = mainWindow.getPosition();
  
  // é€šçŸ¥æ­Œè¯çª—å£è·Ÿéš
  ipcMain.emit('drag-pet', { x, y });
});

// æ­Œè¯çª—å£æ¥æ”¶
ipcMain.on('drag-pet', (event, { x, y }) => {
  lyricsWindow.setPosition(x + 50, y + 100); // åç§»ä½ç½®
});
```

**æ•ˆæœ**ï¼š
- æ‹–åŠ¨ç²¾çµçª—å£ â†’ æ­Œè¯çª—å£å®æ—¶è·Ÿéš
- æ— å»¶è¿Ÿã€æ— å¡é¡¿
- ä¸¤çª—å£ä¿æŒç›¸å¯¹ä½ç½®

---

## æƒ…ç»ªä¸è¡¨æƒ…ç³»ç»Ÿ

### 7ç§æƒ…ç»ªçŠ¶æ€ï¼ˆMood Systemï¼‰

#### æƒ…ç»ªå®šä¹‰

| æƒ…ç»ª | è‹±æ–‡ | é¢œè‰²ä»£ç  | è§¦å‘æ¡ä»¶ | æŒç»­æ—¶é—´ |
|------|------|----------|----------|----------|
| é—²ç½® | idle | `#ff6b6b` â†’ `#ff8c42` | æ— ä»»åŠ¡ | æŒç»­ |
| å¼€å¿ƒ | happy | `#ffd93d` â†’ `#ff6f3c` | æ”¶åˆ°æ¶ˆæ¯ã€ä»»åŠ¡å®Œæˆ | 5ç§’ |
| å¯¹è¯ | talking | `#ff4d94` â†’ `#ff6ec7` | è¯­éŸ³æ’­æ”¾ä¸­ | ç›´åˆ°æ’­æ”¾ï¿½ï¿½æŸ |
| æ€è€ƒ | thinking | `#a78bfa` â†’ `#6366f1` | AIç”Ÿæˆå†…å®¹ä¸­ | ç›´åˆ°ç”Ÿæˆå®Œæˆ |
| å›°äº† | sleepy | `#b8987c` â†’ `#8b7d6b` | 23:00-8:00 æ·±å¤œ | æŒç»­ |
| æƒŠè®¶ | surprised | `#ffb84d` â†’ `#ff9500` | æ”¶åˆ°@æé†’ã€é”™è¯¯ | 3ç§’ |
| ç¦»çº¿ | offline | `#b0b0b0` | OpenClawæœªè¿æ¥ | ç›´åˆ°é‡è¿ |

#### é¢œè‰²è¿‡æ¸¡åŠ¨ç”»

**é—®é¢˜**ï¼šCSS `transition` ä¸æ”¯æŒ `linear-gradient` è¿‡æ¸¡

**è§£å†³æ–¹æ¡ˆ**ï¼šåŠ¨æ€ç”Ÿæˆ `@keyframes`

```javascript
function createColorTransition(fromColor, toColor) {
  const animName = `colorShift-${Date.now()}`;
  const keyframes = `
    @keyframes ${animName} {
      from { background: ${fromColor}; }
      to { background: ${toColor}; }
    }
  `;
  
  // æ³¨å…¥æ ·å¼è¡¨
  const style = document.createElement('style');
  style.textContent = keyframes;
  document.head.appendChild(style);
  
  // åº”ç”¨åŠ¨ç”»ï¼ˆä¸‰å±‚ç‹¬ç«‹æ—¶é—´ï¼‰
  petBall.style.animation = `${animName} 1.0s ease-in-out forwards`;
  blob1.style.animation = `${animName} 0.8s ease-in-out forwards`;
  blob2.style.animation = `${animName} 1.2s ease-in-out forwards`;
}
```

**æ•ˆæœ**ï¼š
- âœ… 1ç§’å¹³æ»‘è¿‡æ¸¡
- âœ… ä¸‰å±‚ç‹¬ç«‹åŠ¨ç”»é€Ÿåº¦ï¼ˆ0.8s/1.0s/1.2sï¼‰
- âœ… è‡ªç„¶çš„é¢œè‰²æ¸å˜ï¼ˆçº¢â†’æ©™â†’é»„é£æ ¼ï¼‰

---

### 38ä¸ªå¾…æœºè¡¨æƒ…åŠ¨ç”»

#### è§¦å‘æœºåˆ¶

```javascript
setInterval(() => {
  if (currentMood === 'idle' && Math.random() < 0.3) {
    // 30%æ¦‚ç‡è§¦å‘
    const randomAct = idleActs[Math.floor(Math.random() * 38)];
    randomAct();
  }
}, 4000); // æ¯4ç§’æ£€æŸ¥ä¸€æ¬¡
```

#### åŠ¨ç”»åˆ†ç±»

**Aç±»ï¼šçœ¼ç›åŠ¨ç”»ï¼ˆ14ä¸ªï¼‰**

1. **å·¦å³å¼ æœ›** â€” å·¦çœ¼â†’å³çœ¼â†’ä¸­å¿ƒï¼Œå„0.3s
2. **å¥½å¥‡æ­ªå¤´** â€” æ•´ä¸ªçƒä½“rotate(-5deg) + çœ¼ç›thinking
3. **å¿«é€Ÿæ‰«è§†** â€” å·¦å³å¿«é€Ÿåˆ‡æ¢3æ¬¡ï¼Œ0.1s/æ¬¡
4. **ä¸Šä¸‹çœ‹** â€” çœ¼ç›translateY(Â±5px)
5. **çœ¨çœ¼** â€” blink 0.1s
6. **åŒçœ¨** â€” blink â†’ 0.2s â†’ blink
7. **ä¸‰è¿çœ¨** â€” blink â†’ blink â†’ blink
8. **æ‡’æ´‹æ´‹çœ¨çœ¼åºåˆ—** â€” blink(0.3s) â†’ åœé¡¿1s â†’ blink(0.2s) â†’ åœé¡¿0.5s â†’ blink(0.15s)
9. **å·¦çœ‹** â€” å·¦çœ¼normal, å³çœ¼thinking
10. **å³çœ‹** â€” å·¦çœ¼thinking, å³çœ¼normal
11. **ä»°æœ›** â€” translateY(-5px) + surprised
12. **ä¿¯è§†** â€” translateY(5px) + sleepy
13. **çœ¯çœ¼å·çœ‹** â€” sleepy â†’ åœé¡¿ â†’ wink
14. **ç¯é¡¾å››å‘¨** â€” å·¦â†’ä¸Šâ†’å³â†’ä¸‹â†’ä¸­å¿ƒ

**Bç±»ï¼šè¡¨æƒ…ç»„åˆï¼ˆ12ä¸ªï¼‰**

15. **å¼€å¿ƒâ†’æƒŠè®¶** â€” happy(1s) â†’ surprised(0.5s) â†’ happy(0.5s)
16. **æ€è€ƒâ†’é—ªäº®** â€” thinking(1.5s) â†’ sparkle(0.3s) â†’ thinking(0.5s)
17. **å›°â†’æƒŠé†’** â€” sleepy(1s) â†’ surprised(0.2s) â†’ normal(0.3s)
18. **å®³ç¾è„¸çº¢** â€” wink + scale(0.95) + çƒä½“é¢œè‰²å˜ç²‰
19. **å¾—æ„è„¸** â€” wink + rotate(3deg)
20. **ç”Ÿæ°”â†’å‘¼å¸** â€” angry(0.8s) â†’ scale(1.05) â†’ scale(0.95) â†’ normal
21. **å›°æƒ‘â†’æç„¶** â€” thinking â†’ rotate(-8deg) â†’ surprised â†’ happy
22. **æ‚²ä¼¤â†’æ¢å¤** â€” sleepy + scale(0.9) â†’ blink â†’ normal
23. **ç‹¡é» å¾®ç¬‘** â€” wink + rotate(5deg) + å°å¹…åº¦bounce
24. **æ˜Ÿæ˜Ÿçœ¼â†’å’¯å’¯ç¬‘** â€” sparkle(0.5s) â†’ happy + bounce(3æ¬¡)
25. **å›°æƒ‘æ­ªå¤´** â€” thinking + rotate(-10deg) + åœé¡¿
26. **å“‡å¡â†’å¥½å¥‡** â€” surprised(0.3s) â†’ sparkle(0.2s) â†’ thinking

**Cç±»ï¼šæƒ…æ„Ÿè¡¨è¾¾ï¼ˆ6ä¸ªï¼‰**

27. **çˆ±å¿ƒçœ¼+è„¸çº¢** â€” love(1s) + çƒä½“å˜ç²‰ + scale(1.05)
28. **ç”Ÿæ°”è·ºè„š** â€” angry + translateY(5pxå¿«é€Ÿ) Ã— 2
29. **è£…æ­»** â€” cross(2s) + rotate(90deg) + opacity(0.5)
30. **å¤´æ™•ç›®çœ©** â€” dizzy + rotate(360deg, 2s) + scale(0.9)
31. **æ‰«æå‘¨å›´** â€” çœ¼ç›å¿«é€Ÿ360åº¦æ—‹è½¬ + thinking
32. **å¼€å¿ƒè¹¦è·¶** â€” happy + translateY(-10px) bounce 3æ¬¡

**Dç±»ï¼šå¤æ‚åºåˆ—ï¼ˆ6ä¸ªï¼‰**

33. **ä¼¸æ‡’è…°** â€” scale(1.1, 1.5sç¼“æ…¢) â†’ scale(1.0, 0.5s) + sleepy
34. **æ‘‡å¤´** â€” rotate(-15deg) â†’ rotate(15deg) â†’ rotate(-15deg) â†’ 0deg
35. **ç‚¹å¤´ç¡®è®¤** â€” translateY(3px) â†’ 0 â†’ translateY(3px) â†’ 0
36. **å‘ä¸Šbounce** â€” translateY(-15px) â†’ 0 (å¼¹æ€§åŠ¨ç”»)
37. **åƒä¸œè¥¿** â€” surprised â†’ love + scale(1.05) â†’ happy + è„¸çº¢
38. **è£…æ­»â†’å¤æ´»** â€” cross + rotate(90deg) â†’ surprised + rotate(0deg) + bounce

---

#### ç¤ºä¾‹ä»£ç 

```javascript
const idleActs = [
  // 1. å·¦å³å¼ æœ›
  () => {
    setEyes('normal', { look: 'left' });
    setTimeout(() => setEyes('normal', { look: 'right' }), 300);
    setTimeout(() => setEyes('normal'), 600);
  },
  
  // 15. å¼€å¿ƒâ†’æƒŠè®¶
  () => {
    setEyes('happy');
    setMood('happy');
    setTimeout(() => setEyes('surprised'), 1000);
    setTimeout(() => {
      setEyes('happy');
      setMood('idle');
    }, 1500);
  },
  
  // 27. çˆ±å¿ƒçœ¼+è„¸çº¢
  () => {
    setEyes('love');
    petBall.style.filter = 'hue-rotate(20deg)'; // å˜ç²‰
    petBall.style.transform = 'scale(1.05)';
    setTimeout(() => {
      setEyes('normal');
      petBall.style.filter = '';
      petBall.style.transform = 'scale(1)';
    }, 1000);
  }
];
```

---

## æ™ºèƒ½è¯­éŸ³ç³»ç»Ÿ

### ä¸‰çº§é™çº§æ¶æ„

```
ä¼˜å…ˆçº§1: MiniMax Speech 2.5 Turbo
   â†“ å¤±è´¥/è¶…æ—¶
ä¼˜å…ˆçº§2: DashScope CosyVoice
   â†“ å¤±è´¥/è¶…æ—¶
ä¼˜å…ˆçº§3: Edge TTSï¼ˆæœ¬åœ°ï¼‰
```

---

### MiniMax Speech 2.5 Turbo

#### é…ç½®

```json
{
  "voice": {
    "engine": "minimax",
    "minimax": {
      "apiKey": "sk-api--xxxxx",
      "groupId": "2020139946483921771",
      "voiceId": "xiaotuantuan_minimax",
      "model": "speech-2.5-turbo-preview",
      "speed": 1.1,
      "vol": 3.0,
      "emotion": "happy"
    }
  }
}
```

#### å…‹éš†éŸ³è‰²æµç¨‹

**ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ éŸ³é¢‘**

```bash
POST https://api.minimax.chat/v1/files/upload
Content-Type: multipart/form-data

{
  "file": "xiaotuantuan_nav.mp3",  # 81ç§’ï¼Œæœ‰èƒŒæ™¯éŸ³ä¹ä¹ŸOK
  "purpose": "voice_clone"
}

Response:
{
  "file_id": "364335525450134"
}
```

**ç¬¬äºŒæ­¥ï¼šåˆ›å»ºéŸ³è‰²**

```bash
POST https://api.minimax.chat/v1/voice_clone
{
  "file_id": "364335525450134",
  "voice_name": "xiaotuantuan_minimax"
}

Response:
{
  "voice_id": "xiaotuantuan_minimax",
  "status": "processing"
}
```

ç­‰å¾…5-10åˆ†é’Ÿï¼ŒéŸ³è‰²åˆ›å»ºå®Œæˆã€‚

**ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨**

```bash
POST https://api.minimax.chat/v1/t2a_v2
{
  "model": "speech-2.5-turbo-preview",
  "text": "KKï¼Œæˆ‘çœ‹åˆ°ä½ çš„æ¶ˆæ¯å•¦ï¼<#0.5#>ç°åœ¨å¼€å§‹å¸®ä½ å¤„ç†",
  "voice_setting": {
    "voice_id": "xiaotuantuan_minimax",
    "speed": 1.1,
    "vol": 3.0,
    "emotion": "happy"
  }
}
```

#### 7ç§æƒ…æ„Ÿ

| æƒ…æ„Ÿ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹æ–‡æœ¬ |
|------|----------|----------|
| happy | ä»»åŠ¡å®Œæˆã€æ”¶åˆ°å¥½æ¶ˆæ¯ | "å¤ªå¥½äº†ï¼å·²ç»æå®š~" |
| sad | å¤±è´¥ã€é”™è¯¯ | "æŠ±æ­‰ï¼Œå‡ºäº†ç‚¹é—®é¢˜..." |
| angry | è­¦å‘Šã€ç´§æ€¥ | "æ³¨æ„ï¼ç³»ç»Ÿèµ„æºä¸è¶³ï¼" |
| fearful | ä¸ç¡®å®šã€æ‹…å¿ƒ | "è¿™ä¸ªæ“ä½œå¯èƒ½æœ‰é£é™©..." |
| disgusted | æ‹’ç»ã€ä¸æ¨è | "è¿™ä¸ªæ–¹æ¡ˆä¸å¤ªåˆé€‚" |
| surprised | æ„å¤–ã€å‘ç° | "å“‡ï¼å‘ç°äº†æ–°åŠŸèƒ½ï¼" |
| calm | å¹³é™ã€è¯´æ˜ | "è®©æˆ‘ä¸ºä½ è§£é‡Šä¸€ä¸‹" |

#### è‡ªåŠ¨æƒ…æ„Ÿè¯†åˆ«

```javascript
function detectEmotion(text) {
  // å¼€å¿ƒ
  if (/å¤ªå¥½|æˆåŠŸ|å®Œæˆ|æå®š|è€¶|æ£’|èµ/.test(text)) {
    return 'happy';
  }
  // æƒŠè®¶
  if (/å“‡|å¤©å“ª|ä»€ä¹ˆ|ï¼ï¼Ÿ|ç«Ÿç„¶/.test(text)) {
    return 'surprised';
  }
  // æ‚²ä¼¤
  if (/å¤±è´¥|é”™è¯¯|æŠ±æ­‰|é—æ†¾|å¯æƒœ/.test(text)) {
    return 'sad';
  }
  // é»˜è®¤å¹³é™
  return 'calm';
}
```

#### åœé¡¿æ§åˆ¶

```javascript
const text = "KKï¼Œæˆ‘çœ‹åˆ°ä½ çš„æ¶ˆæ¯å•¦ï¼<#0.5#>ç°åœ¨å¼€å§‹å¸®ä½ å¤„ç†<#0.3#>ç¨ç­‰ä¸€ä¸‹å“¦";
// ä¼šåœ¨"å•¦"ååœé¡¿0.5ç§’ï¼Œ"ç†"ååœé¡¿0.3ç§’
```

#### è´¹ç”¨

- **TTSè´¹ç”¨**ï¼š2å…ƒ/ä¸‡å­—ç¬¦
- **å…‹éš†è´¹ç”¨**ï¼š9.9å…ƒ/éŸ³è‰²ï¼ˆä¸€æ¬¡æ€§ï¼‰
- **åŒéŸ³è‰²åˆ‡æ¢**ï¼šHD â†” Turbo å…è´¹

---

### DashScope CosyVoice

#### é…ç½®

```json
{
  "voice": {
    "engine": "dashscope",
    "dashscope": {
      "apiKey": "sk-aa02695435f240558af5218319a60b56",
      "model": "cosyvoice-v3-plus",
      "voice": "cosyvoice-v3-plus-tuantuan-xxx"
    }
  }
}
```

#### ä½¿ç”¨

```python
from dashscope.audio.tts_v2 import SpeechSynthesizer

synthesizer = SpeechSynthesizer(
    model='cosyvoice-v3-plus',
    voice='cosyvoice-v3-plus-tuantuan-xxx'
)

audio = synthesizer.call(text="KKï¼Œæˆ‘çœ‹åˆ°ä½ çš„æ¶ˆæ¯å•¦")
audio_data = synthesizer.get_audio_data()

with open('output.wav', 'wb') as f:
    f.write(audio_data)
```

#### è´¹ç”¨

- **å…è´¹é¢åº¦**ï¼šæ¯æœˆ500ä¸‡å­—ç¬¦
- **è¶…å‡ºå**ï¼šæŒ‰é‡è®¡è´¹

---

### Edge TTSï¼ˆé™çº§æ–¹æ¡ˆï¼‰

```bash
edge-tts --voice zh-CN-XiaoxiaoNeural --text "KKæ”¶åˆ°" --write-media output.mp3
```

- **ä¼˜ç‚¹**ï¼šå®Œå…¨å…è´¹ï¼Œæœ¬åœ°è¿è¡Œ
- **ç¼ºç‚¹**ï¼šéŸ³è´¨ä¸€èˆ¬ï¼Œæ— æ³•å…‹éš†

---

### è¯­éŸ³æ’­æŠ¥æµç¨‹

```javascript
async function speak(text) {
  // 1. è®¾ç½®moodä¸ºtalking
  setMood('talking');
  
  // 2. è‡ªåŠ¨æ£€æµ‹æƒ…æ„Ÿ
  const emotion = detectEmotion(text);
  
  // 3. ä¸‰çº§é™çº§
  let audioPath;
  try {
    audioPath = await minimaxTTS(text, emotion);
  } catch (e) {
    console.warn('MiniMaxå¤±è´¥ï¼Œé™çº§åˆ°DashScope');
    try {
      audioPath = await dashscopeTTS(text);
    } catch (e2) {
      console.warn('DashScopeå¤±è´¥ï¼Œé™çº§åˆ°Edge');
      audioPath = await edgeTTS(text);
    }
  }
  
  // 4. æ’­æ”¾éŸ³é¢‘
  await playAudio(audioPath);
  
  // 5. æ˜¾ç¤ºæ­Œè¯ï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰
  await typeText(text);
  
  // 6. æ¢å¤idle
  setMood('idle');
}
```

---

## KKClaw Switché›†æˆ

### ä»€ä¹ˆæ˜¯KKClaw Switchï¼Ÿ

**é—®é¢˜**ï¼šAIæ¨¡å‹åˆ‡æ¢éœ€è¦ï¼š
1. æ‰“å¼€é…ç½®æ–‡ä»¶
2. ä¿®æ”¹provider
3. é‡å¯Gateway
4. ç­‰å¾…30ç§’

**KKClaw Switchè§£å†³æ–¹æ¡ˆ**ï¼š
- ç‚¹å‡»åˆ‡æ¢ â†’ 3ç§’ç”Ÿæ•ˆ
- æ— éœ€ç¼–è¾‘æ–‡ä»¶
- è‡ªåŠ¨é‡å¯
- å¯¹è¯ä¸ä¸­æ–­

---

### å·¥ä½œåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ KKClaw Switchâ”‚ â†’   â”‚ SQLite DB    â”‚ â†’   â”‚ Auto Monitor â”‚
â”‚ é€‰æ‹©provider â”‚     â”‚ ä¿å­˜é€‰æ‹©     â”‚     â”‚ æ¯2ç§’æ£€æµ‹     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â†“
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚ Sync Script  â”‚
                                          â”‚ è¯»å–DB       â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â†“
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚ OpenClaw     â”‚
                                          â”‚ æ›´æ–°config   â”‚
                                          â”‚ é‡å¯Gateway  â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### é›†æˆæ–¹å¼

#### è‡ªåŠ¨åŒæ­¥ï¼ˆæ¨èï¼‰

**æ¡Œé¢é¾™è™¾å¯åŠ¨æ—¶è‡ªåŠ¨å¼€å¯ç›‘å¬å™¨**ï¼š

```javascript
// main.js
const { spawn } = require('child_process');

let syncWatcher;

app.on('ready', () => {
  // å¯åŠ¨è‡ªåŠ¨åŒæ­¥ç›‘å¬å™¨
  syncWatcher = spawn('node', [
    path.join(__dirname, 'kkclaw-auto-sync.js')
  ], {
    detached: false,
    stdio: 'inherit'
  });
  
  console.log('âœ… KKClaw auto-sync started');
});

app.on('will-quit', () => {
  // å…³é—­æ—¶åœæ­¢ç›‘å¬å™¨
  if (syncWatcher) {
    syncWatcher.kill();
  }
});
```

**ç›‘å¬å™¨ä»£ç **ï¼š

```javascript
// kkclaw-auto-sync.js
const Database = require('better-sqlite3');
const { execSync } = require('child_process');
const path = require('path');
const os = require('os');

const DB_PATH = path.join(os.homedir(), '.cc-switch', 'cc-switch.db');
let lastProvider = null;

setInterval(() => {
  try {
    const db = new Database(DB_PATH, { readonly: true });
    const row = db.prepare('SELECT name FROM active_provider LIMIT 1').get();
    db.close();
    
    const currentProvider = row?.name;
    
    if (currentProvider && currentProvider !== lastProvider) {
      console.log(`ğŸ”„ Provider changed: ${lastProvider} â†’ ${currentProvider}`);
      
      // æ‰§è¡ŒåŒæ­¥
      execSync('node kkclaw-hotswitch.js --restart', {
        cwd: __dirname,
        stdio: 'inherit'
      });
      
      lastProvider = currentProvider;
    }
  } catch (e) {
    // DBæ–‡ä»¶ä¸å­˜åœ¨æˆ–è¯»å–å¤±è´¥ï¼Œç­‰å¾…ä¸‹æ¬¡æ£€æŸ¥
  }
}, 2000); // æ¯2ç§’æ£€æŸ¥
```

---

#### æ‰‹åŠ¨åŒæ­¥ï¼ˆå¯é€‰ï¼‰

```bash
# æ–¹å¼1ï¼šåªåŒæ­¥configï¼Œä¸é‡å¯
node kkclaw-hotswitch.js

# æ–¹å¼2ï¼šåŒæ­¥ + é‡å¯Gateway
node kkclaw-hotswitch.js --restart
```

**åŒæ­¥è„šæœ¬**ï¼š

```javascript
// kkclaw-hotswitch.js
const Database = require('better-sqlite3');
const fs = require('fs');
const path = require('path');
const os = require('os');
const { execSync } = require('child_process');

// 1. è¯»å–KKClaw Switch DB
const dbPath = path.join(os.homedir(), '.cc-switch', 'cc-switch.db');
const db = new Database(dbPath, { readonly: true });
const row = db.prepare('SELECT name FROM active_provider LIMIT 1').get();
db.close();

const activeProvider = row?.name;
if (!activeProvider) {
  console.error('âŒ No active provider found');
  process.exit(1);
}

// 2. è¯»å–OpenClaw config
const configPath = path.join(os.homedir(), '.openclaw', 'openclaw.json');
const config = JSON.parse(fs.readFileSync(configPath, 'utf8'));

// 3. æ›´æ–°defaultProvider
config.defaultProvider = activeProvider;

// 4. å†™å›config
fs.writeFileSync(configPath, JSON.stringify(config, null, 2));
console.log(`âœ… Synced: defaultProvider = ${activeProvider}`);

// 5. é‡å¯Gatewayï¼ˆå¦‚æœæŒ‡å®š--restartï¼‰
if (process.argv.includes('--restart')) {
  console.log('ğŸ”„ Restarting OpenClaw Gateway...');
  try {
    execSync('openclaw gateway restart', { stdio: 'inherit' });
    console.log('âœ… Gateway restarted');
  } catch (e) {
    console.error('âŒ Restart failed:', e.message);
  }
}
```

---

### ä½¿ç”¨åœºæ™¯

**åœºæ™¯1ï¼šå¿«é€Ÿåˆ‡æ¢æ¨¡å‹**

```
ä½ ï¼šéœ€è¦å†™é•¿æ–‡æ¡£
æ“ä½œï¼šKKClaw Switch â†’ é€‰æ‹© Claude Opus 4
ç»“æœï¼š3ç§’åç”Ÿæ•ˆï¼Œå¼€å§‹ä½¿ç”¨Opuså†™ä½œ

ä½ ï¼šéœ€è¦å¿«é€Ÿå›ç­”
æ“ä½œï¼šKKClaw Switch â†’ é€‰æ‹© GPT-5.3
ç»“æœï¼š3ç§’åç”Ÿæ•ˆï¼Œåˆ‡æ¢åˆ°GPT
```

**åœºæ™¯2ï¼šæˆæœ¬ä¼˜åŒ–**

```
æ™®é€šä»»åŠ¡ï¼šä½¿ç”¨ deepseek-chatï¼ˆä¾¿å®œï¼‰
å¤æ‚ä»»åŠ¡ï¼šä½¿ç”¨ claude-opus-4ï¼ˆè´µä½†å¼ºï¼‰
ä»£ç ä»»åŠ¡ï¼šä½¿ç”¨ gpt-5.3-codexï¼ˆä¸“ä¸šï¼‰
```

**åœºæ™¯3ï¼šå¤šAPIå¯†é’¥ç®¡ç†**

```
Provider 1: ä¿±ä¹éƒ¨è‡ªç”¨ç»Ÿä¸€ï¼ˆgptclubapiä¸­è½¬ï¼‰
Provider 2: å®˜æ–¹APIï¼ˆOpenAI/Anthropicï¼‰
Provider 3: æœ¬åœ°æ¨¡å‹ï¼ˆOllamaï¼‰
```

---

## å·¥å…·æ ä¸äº¤äº’

### å³é”®èœå•

**å®Œæ•´èœå•é¡¹**ï¼š

```javascript
const contextMenu = Menu.buildFromTemplate([
  {
    label: 'ğŸ¨ è®¾ç½®æƒ…ç»ª',
    submenu: [
      { label: 'ğŸ”´ é—²ç½® (Idle)', click: () => setMood('idle') },
      { label: 'ğŸŸ¡ å¼€å¿ƒ (Happy)', click: () => setMood('happy') },
      { label: 'ğŸ’— å¯¹è¯ (Talking)', click: () => setMood('talking') },
      { label: 'ğŸ”µ æ€è€ƒ (Thinking)', click: () => setMood('thinking') },
      { label: 'ğŸ¤ å›°äº† (Sleepy)', click: () => setMood('sleepy') },
      { label: 'ğŸŸ  æƒŠè®¶ (Surprised)', click: () => setMood('surprised') },
      { label: 'âš« ç¦»çº¿ (Offline)', click: () => setMood('offline') }
    ]
  },
  { type: 'separator' },
  {
    label: 'ğŸ™ï¸ è¯­éŸ³è®¾ç½®',
    submenu: [
      { label: 'ğŸ¤ MiniMax Turbo', click: () => setVoice('minimax') },
      { label: 'ğŸ”Š DashScope', click: () => setVoice('dashscope') },
      { label: 'ğŸ“¢ Edge TTS', click: () => setVoice('edge') }
    ]
  },
  { type: 'separator' },
  {
    label: 'ğŸ“¸ æˆªå›¾ä¸Šä¼ ',
    accelerator: 'Ctrl+Shift+S',
    click: () => takeScreenshot()
  },
  {
    label: 'ğŸ’¬ æ‰“å¼€èŠå¤©',
    accelerator: 'Ctrl+Shift+C',
    click: () => openChat()
  },
  { type: 'separator' },
  {
    label: 'ğŸ” KKClaw Switch',
    click: () => openKKClawSwitch()
  },
  {
    label: 'âš™ï¸ è®¾ç½®',
    accelerator: 'Ctrl+Shift+P',
    click: () => openSettings()
  },
  { type: 'separator' },
  {
    label: 'ğŸ”„ é‡å¯',
    click: () => app.relaunch(); app.quit();
  },
  {
    label: 'âŒ é€€å‡º',
    accelerator: 'Ctrl+Q',
    click: () => app.quit()
  }
]);
```

---

### æˆªå›¾ä¸Šä¼ åŠŸèƒ½

**æµç¨‹**ï¼š

```
1. è§¦å‘ï¼ˆCtrl+Shift+S æˆ–ç‚¹å‡»å›¾æ ‡ï¼‰
   â†“
2. å…¨å±æˆªå›¾ï¼ˆpyautoguiæˆ–PowerShellï¼‰
   â†“
3. ä¿å­˜ä¸´æ—¶æ–‡ä»¶
   â†“
4. è°ƒç”¨é£ä¹¦ä¸Šä¼ API
   â†“
5. è·å–image_key
   â†“
6. å‘é€åˆ°é£ä¹¦å¯¹è¯
   â†“
7. åˆ é™¤ä¸´æ—¶æ–‡ä»¶
```

**ä»£ç **ï¼š

```javascript
async function takeScreenshot() {
  try {
    // 1. æˆªå›¾
    const tempPath = path.join(os.tmpdir(), `screenshot-${Date.now()}.png`);
    await execAsync(`python -c "import pyautogui; pyautogui.screenshot('${tempPath}')"`);
    
    // 2. ä¸Šä¼ åˆ°é£ä¹¦
    const imageKey = await uploadToFeishu(tempPath);
    
    // 3. å‘é€æ¶ˆæ¯
    await sendFeishuMessage({
      msg_type: 'image',
      content: {
        image_key: imageKey
      }
    });
    
    // 4. æ¸…ç†
    fs.unlinkSync(tempPath);
    
    console.log('âœ… Screenshot uploaded');
  } catch (e) {
    console.error('âŒ Screenshot failed:', e);
  }
}
```

---

## ç¨³å®šæ€§ç³»ç»Ÿ

### è‡ªåŠ¨é‡å¯æœºåˆ¶

#### Electronè¿›ç¨‹å´©æºƒ

```javascript
// main.js
process.on('uncaughtException', (error) => {
  console.error('ğŸ’¥ Uncaught Exception:', error);
  
  // è®°å½•æ—¥å¿—
  fs.appendFileSync('logs/crash.log', `${new Date().toISOString()} ${error.stack}\n`);
  
  // 5ç§’åé‡å¯
  setTimeout(() => {
    app.relaunch();
    app.exit(0);
  }, 5000);
});
```

#### OpenClaw GatewayæŒ‚æ‰

```javascript
// gateway-guardian.js
setInterval(async () => {
  try {
    const response = await fetch('http://localhost:3000/health');
    if (!response.ok) throw new Error('Gateway unhealthy');
  } catch (e) {
    console.warn('ğŸš¨ Gateway down, restarting...');
    
    execSync('openclaw gateway restart', { stdio: 'inherit' });
    
    // ç­‰å¾…30ç§’å¯åŠ¨
    await sleep(30000);
  }
}, 60000); // æ¯åˆ†é’Ÿæ£€æŸ¥
```

---

### æ—¥å¿—è½®è½¬

**ç­–ç•¥**ï¼š
- æ¯æ—¥è½®è½¬
- ä¿ç•™7å¤©
- å•æ–‡ä»¶10MBé™åˆ¶
- è‡ªåŠ¨å‹ç¼©ä¸º.gz

```javascript
// log-rotation.js
const winston = require('winston');
require('winston-daily-rotate-file');

const logger = winston.createLogger({
  level: 'info',
  format: winston.format.combine(
    winston.format.timestamp(),
    winston.format.json()
  ),
  transports: [
    new winston.transports.DailyRotateFile({
      filename: 'logs/app-%DATE%.log',
      datePattern: 'YYYY-MM-DD',
      maxSize: '10m',
      maxFiles: '7d',
      zippedArchive: true
    }),
    new winston.transports.DailyRotateFile({
      level: 'error',
      filename: 'logs/error-%DATE%.log',
      datePattern: 'YYYY-MM-DD',
      maxSize: '10m',
      maxFiles: '30d',
      zippedArchive: true
    })
  ]
});
```

---

### æ€§èƒ½ç›‘æ§

```javascript
// performance-monitor.js
setInterval(() => {
  const cpuUsage = process.cpuUsage();
  const memUsage = process.memoryUsage();
  
  const cpuPercent = (cpuUsage.user + cpuUsage.system) / 1000000 / 1; // ç®€åŒ–è®¡ç®—
  const memMB = memUsage.heapUsed / 1024 / 1024;
  
  // è®°å½•
  logger.info('Performance', {
    cpu: cpuPercent.toFixed(2) + '%',
    memory: memMB.toFixed(2) + 'MB',
    uptime: process.uptime()
  });
  
  // å‘Šè­¦
  if (cpuPercent > 80) {
    logger.warn('âš ï¸ High CPU usage:', cpuPercent);
  }
  if (memMB > 500) {
    logger.warn('âš ï¸ High memory usage:', memMB);
  }
}, 60000); // æ¯åˆ†é’Ÿ
```

---

### ç¼“å­˜ç®¡ç†

```javascript
// cache-manager.js
const cron = require('node-cron');

// æ¯å¤©å‡Œæ™¨3ç‚¹æ¸…ç†
cron.schedule('0 3 * * *', () => {
  const tempDir = path.join(__dirname, 'temp');
  const files = fs.readdirSync(tempDir);
  
  let cleaned = 0;
  files.forEach(file => {
    const filePath = path.join(tempDir, file);
    const stat = fs.statSync(filePath);
    
    // åˆ é™¤è¶…è¿‡24å°æ—¶çš„æ–‡ä»¶
    if (Date.now() - stat.mtimeMs > 24 * 60 * 60 * 1000) {
      fs.unlinkSync(filePath);
      cleaned++;
    }
  });
  
  logger.info(`ğŸ§¹ Cleaned ${cleaned} temp files`);
});
```

---

## é…ç½®ä¸å®šåˆ¶

### é…ç½®æ–‡ä»¶ç»“æ„

```json
{
  "openclaw": {
    "gateway": "http://localhost:3000",
    "sessionKey": "main",
    "checkInterval": 2000,
    "reconnectDelay": 5000
  },
  
  "window": {
    "position": { "x": 100, "y": 100 },
    "lyricsOffset": { "x": 50, "y": 100 },
    "alwaysOnTop": true,
    "opacity": 1.0,
    "clickThrough": false
  },
  
  "appearance": {
    "ballSize": 67,
    "defaultMood": "idle",
    "enableIdleAnimations": true,
    "animationSpeed": 1.0
  },
  
  "voice": {
    "engine": "minimax",
    "enabled": true,
    "autoEmotion": true,
    "minimax": {
      "apiKey": "sk-api--xxxxx",
      "groupId": "2020139946483921771",
      "voiceId": "xiaotuantuan_minimax",
      "model": "speech-2.5-turbo-preview",
      "speed": 1.1,
      "vol": 3.0,
      "emotion": "happy"
    },
    "dashscope": {
      "apiKey": "sk-xxxxxxxxxx",
      "model": "cosyvoice-v3-plus",
      "voice": "cosyvoice-v3-plus-tuantuan-xxx"
    },
    "edge": {
      "voice": "zh-CN-XiaoxiaoNeural"
    }
  },
  
  "feishu": {
    "enabled": true,
    "autoUpload": true
  },
  
  "performance": {
    "fps": 60,
    "enableMonitoring": true,
    "logLevel": "info"
  }
}
```

---

### è‡ªå®šä¹‰éŸ³è‰²

**æ­¥éª¤1ï¼šå‡†å¤‡éŸ³é¢‘**

è¦æ±‚ï¼š
- æ ¼å¼ï¼šMP3/WAV
- æ—¶é•¿ï¼š30ç§’-5åˆ†é’Ÿ
- è¯­è¨€ï¼šæ¸…æ™°ã€æ— å™ªéŸ³
- å†…å®¹ï¼šè‡ªç„¶å¯¹è¯ï¼ˆæœ‰èƒŒæ™¯éŸ³ä¹ä¹Ÿå¯ä»¥ï¼‰

**æ­¥éª¤2ï¼šä¸Šä¼ å…‹éš†**

```bash
curl -X POST https://api.minimax.chat/v1/files/upload \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -F "file=@my_voice.mp3" \
  -F "purpose=voice_clone"

# è·å¾—file_idå
curl -X POST https://api.minimax.chat/v1/voice_clone \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{
    "file_id": "è·å¾—çš„file_id",
    "voice_name": "my_custom_voice"
  }'
```

**æ­¥éª¤3ï¼šé…ç½®ä½¿ç”¨**

```json
{
  "voice": {
    "minimax": {
      "voiceId": "my_custom_voice"
    }
  }
}
```

---

## ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šä¸“æ³¨å·¥ä½œæ¨¡å¼

**éœ€æ±‚**ï¼šé•¿æ—¶é—´ç¼–ç¨‹/å†™ä½œï¼Œéœ€è¦AIéšæ—¶å¾…å‘½

**é…ç½®**ï¼š
- mood: thinkingï¼ˆä¿æŒä¸“æ³¨çŠ¶æ€ï¼‰
- ç¦ç”¨å¾…æœºåŠ¨ç”»ï¼ˆå‡å°‘å¹²æ‰°ï¼‰
- è¯­éŸ³ï¼šcalmæƒ…æ„Ÿ

**æ“ä½œ**ï¼š
1. å³é”® â†’ è®¾ç½®æƒ…ç»ª â†’ æ€è€ƒ
2. é…ç½®æ–‡ä»¶ï¼š`"enableIdleAnimations": false`
3. éœ€è¦æ—¶ç›´æ¥é—®é—®é¢˜ï¼Œé¾™è™¾çƒä¼šç«‹å³å“åº”

---

### åœºæ™¯2ï¼šæ·±å¤œåˆ›ä½œ

**éœ€æ±‚**ï¼š23:00åç»§ç»­å·¥ä½œï¼Œéœ€è¦é™ªä¼´ä½†ä¸æ‰“æ‰°

**è‡ªåŠ¨è§¦å‘**ï¼š
- 23:00-8:00è‡ªåŠ¨åˆ‡æ¢sleepy mood
- é™ä½è¯­éŸ³éŸ³é‡
- å¾…æœºåŠ¨ç”»é¢‘ç‡é™ä½50%

**é…ç½®**ï¼š
```json
{
  "appearance": {
    "nightMode": {
      "enabled": true,
      "start": "23:00",
      "end": "08:00",
      "mood": "sleepy",
      "animationFrequency": 0.5
    }
  },
  "voice": {
    "minimax": {
      "vol": 2.0  // é™ä½éŸ³é‡
    }
  }
}
```

---

### åœºæ™¯3ï¼šå›¢é˜Ÿåä½œ

**éœ€æ±‚**ï¼šå¤šäººå…±äº«å±å¹•ï¼Œéœ€è¦å±•ç¤ºAIåŠ©æ‰‹

**é…ç½®**ï¼š
- æ”¾å¤§çƒä½“å°ºå¯¸ï¼ˆä¾¿äºè§‚çœ‹ï¼‰
- å¯ç”¨æ‰€æœ‰åŠ¨ç”»ï¼ˆå±•ç¤ºæ•ˆæœï¼‰
- ä½¿ç”¨happy moodï¼ˆç§¯ææ°›å›´ï¼‰

```json
{
  "appearance": {
    "ballSize": 100,  // æ”¾å¤§åˆ°100px
    "enableIdleAnimations": true,
    "defaultMood": "happy"
  }
}
```

---

### åœºæ™¯4ï¼šå¤šæ¨¡å‹åˆ‡æ¢

**éœ€æ±‚**ï¼šä¸åŒä»»åŠ¡ç”¨ä¸åŒæ¨¡å‹

**å·¥ä½œæµ**ï¼š
1. æ‰“å¼€KKClaw Switch
2. é¢„è®¾3ä¸ªprofileï¼š
   - å†™ä½œï¼šClaude Opus 4
   - ç¼–ç¨‹ï¼šGPT-5.3 Codex
   - å¿«é—®å¿«ç­”ï¼šDeepSeek Chat
3. ä»»åŠ¡åˆ‡æ¢æ—¶ç‚¹å‡»åˆ‡æ¢ï¼Œ3ç§’ç”Ÿæ•ˆ

---

## æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

**å‰ç«¯**ï¼š
- Electron 28.x
- HTML5 + CSS3
- Vanilla JavaScriptï¼ˆæ— æ¡†æ¶ï¼‰

**åç«¯**ï¼š
- Node.js 18.x
- SQLiteï¼ˆKKClaw Switch DBï¼‰
- Python 3.10ï¼ˆæˆªå›¾ã€TTSè¾…åŠ©ï¼‰

**é€šä¿¡**ï¼š
- IPCï¼ˆä¸»è¿›ç¨‹ â†” æ¸²æŸ“è¿›ç¨‹ï¼‰
- HTTP/WebSocketï¼ˆOpenClaw Gatewayï¼‰
- REST APIï¼ˆMiniMaxã€DashScopeï¼‰

**å­˜å‚¨**ï¼š
- JSONé…ç½®æ–‡ä»¶
- SQLiteæ•°æ®åº“
- æœ¬åœ°æ—¥å¿—æ–‡ä»¶

---

### æ–‡ä»¶ç»“æ„

```
desktop-pet/
â”œâ”€â”€ main.js                    # Electronä¸»è¿›ç¨‹
â”œâ”€â”€ index.html                # ç²¾çµçª—å£UI
â”œâ”€â”€ lyrics.html               # æ­Œè¯çª—å£UI
â”œâ”€â”€ model-settings.html       # è®¾ç½®é¢æ¿
â”‚
â”œâ”€â”€ voice/                    # è¯­éŸ³å¼•æ“
â”‚   â”œâ”€â”€ minimax-tts.js
â”‚   â”œâ”€â”€ dashscope-tts.js
â”‚   â”œâ”€â”€ cosyvoice-tts.py
â”‚   â””â”€â”€ voice-system.js
â”‚
â”œâ”€â”€ utils/                    # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ notify-desktop.js
â”‚   â”œâ”€â”€ auto-notify.js
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ scripts/                  # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ take_screenshots.py
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ tests/                    # æµ‹è¯•
â”œâ”€â”€ docs-dev/                 # å¼€å‘æ–‡æ¡£
â”œâ”€â”€ archive/                  # å½’æ¡£
â”‚
â”œâ”€â”€ kkclaw-hotswitch.js       # æ¨¡å‹åˆ‡æ¢è„šæœ¬
â”œâ”€â”€ kkclaw-auto-sync.js       # è‡ªåŠ¨åŒæ­¥ç›‘å¬å™¨
â”œâ”€â”€ create-shortcut.ps1       # å¿«æ·æ–¹å¼ç”Ÿæˆ
â”‚
â”œâ”€â”€ package.json
â”œâ”€â”€ pet-config.json           # é…ç½®æ–‡ä»¶ï¼ˆä¸æäº¤ï¼‰
â””â”€â”€ README.md
```

---

### æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        User Actions                         â”‚
â”‚  (æ‹–åŠ¨/ç‚¹å‡»/å³é”®/å¿«æ·é”®)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Electron Main Process                    â”‚
â”‚  - Window Management                                        â”‚
â”‚  - IPC Communication                                        â”‚
â”‚  - System Integration                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                    â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Renderer (Pet) â”‚  â”‚ Renderer (Lyrics)â”‚ â”‚  Settings      â”‚
â”‚  - UI Render   â”‚  â”‚  - Text Display  â”‚  â”‚  - Config UI   â”‚
â”‚  - Animations  â”‚  â”‚  - Typewriter    â”‚  â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OpenClaw Client                          â”‚
â”‚  - WebSocket Connection                                     â”‚
â”‚  - Message Sync                                             â”‚
â”‚  - Status Polling                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    OpenClaw Gateway                         â”‚
â”‚  - AI Model Routing                                         â”‚
â”‚  - Session Management                                       â”‚
â”‚  - Plugin System                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                    â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI Providers  â”‚  â”‚  Voice APIs    â”‚  â”‚  Feishu API    â”‚
â”‚  (Claude/GPT)  â”‚  â”‚  (MiniMax/etc) â”‚  â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å¼€å‘è·¯çº¿å›¾

### V2.1ï¼ˆè®¡åˆ’ä¸­ï¼‰

- [ ] å¤šä¸»é¢˜çš®è‚¤ç³»ç»Ÿ
- [ ] è‡ªå®šä¹‰é¢œè‰²æ–¹æ¡ˆ
- [ ] æ›´å¤šå¾…æœºåŠ¨ä½œï¼ˆ50+ï¼‰
- [ ] æ’ä»¶ç³»ç»Ÿï¼ˆå…è®¸ç¬¬ä¸‰æ–¹æ‰©å±•ï¼‰
- [ ] Linux/macOSæ”¯æŒ

### V3.0ï¼ˆæœªæ¥ï¼‰

- [ ] å¤šé¾™è™¾çƒï¼ˆå›¢é˜Ÿæ¨¡å¼ï¼‰
- [ ] ARæŠ•å½±æ¨¡å¼
- [ ] æ‰‹åŠ¿è¯†åˆ«äº¤äº’
- [ ] å®Œæ•´çš„æƒ…æ„ŸAIç³»ç»Ÿ

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼š2.0.3  
**æœ€åæ›´æ–°**ï¼š2026-02-11  
**ç»´æŠ¤è€…**ï¼šå°K
